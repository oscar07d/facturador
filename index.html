<!DOCTYPE html>
<html lang="es-CO">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facturación OSCAR 07D Studios (v2.3.4)</title>
    
    <link rel="stylesheet" href="styles.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script src="script.js" defer></script>
</head>
<body>
    <!-- ========= PANTALLA DE CARGA INICIAL ========= -->
    <div id="initial-loader-screen">
        <!-- Logo SVG Incrustado -->
        <div id="loader-logo-container">
            <?xml version="1.0" encoding="UTF-8"?>
            <svg id="loader-logo-svg" data-name="Capa 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 879.14 85.62">
              <!-- <defs>QUITAMOS LA DEFINICIÓN DE CLASE ORIGINAL PARA EVITAR CONFLICTOS O PARA QUE SEA MÁS FÁCIL SOBREESCRIBIR
                <style>
                  .cls-1 {
                    fill: #1d1d1b;
                  }
                </style>
              </defs> -->
              <g id="Capa_2-2" data-name="Capa 2">
                <g id="Imagotipo">
                  <g>
                    <path class="cls-1 svg-shape" d="M110.22,49.35l-10.41,10.41c3.95,8.61,12.65,14.6,22.74,14.6h0c13.81,0,25.47-8.41,25.47-22.22,0,0,1.07-16.23-15.49-19.61-9.39-1.91-13.45-5.24-15.19-7.53-1.22-1.61-1.55-3.78-.7-5.62,.72-1.56,2.29-3.12,5.74-3.12,9.24,0,12.17,8.74,12.17,8.74l10.63-10.63C141.2,5.88,132.57,0,122.56,0h0C108.75,0,99.88,10.27,99.88,24.07c0,0-.21,11.49,13.34,18.14,.92,.45,1.88,.82,2.85,1.14,1.89,.63,5.2,1.73,5.4,1.79,.93,.32,9.06,2.11,9.31,6.62,.22,3.99-2.48,6.99-8.78,5.75-4.32-.85-11.77-8.18-11.77-8.18Z"/>
                    <polygon class="cls-1 svg-shape" points="248.32 27.08 233.59 74.35 211.15 74.35 237.1 0 259.54 0 285.5 74.35 263.06 74.35 248.32 27.08"/>
                    <path class="cls-1 svg-shape" d="M199.2,50.32l13.15,13.15c-6.73,6.72-16.02,10.89-26.29,10.89-20.53,0-37.17-16.64-37.17-37.17S165.53,0,186.05,0C196.32,0,205.61,4.16,212.34,10.89l-13.15,13.15c-3.36-3.36-8.01-5.45-13.14-5.45-10.26,0-18.59,8.32-18.59,18.59s8.32,18.59,18.59,18.59c5.13,0,9.78-2.08,13.14-5.45Z"/>
                    <path class="svg-shape" d="M305.28,46.55h0v27.8h-16.53V0h29.39c14.64,0,24.06,10.04,24.06,23.22,0,10.04-5.54,17.68-14.64,20.92l15.06,30.21h-18.2l-10.74-22.52c-1.55-3.23-4.82-5.28-8.4-5.28Zm9.73-14.23c6.8,0,10.46-3.77,10.46-9,0-5.54-3.66-9-10.46-9h-9.73v17.99h9.73Z"/>
                    <path class="svg-shape" d="M414.41,7.4C409.84,2.83,403.53,0,396.56,0,382.61,0,371.31,11.31,371.31,25.25v23.85c0,13.95,11.31,25.25,25.25,25.25s25.25-11.31,25.25-25.25V25.25c0-6.97-2.83-13.29-7.4-17.85Zm-7.91,41.38c0,6.28-3.65,11.38-9.94,11.38s-9.94-5.1-9.94-11.38V25.57c0-6.28,3.65-11.38,9.94-11.38s9.94,5.23,9.94,11.38v23.21Z"/>
                    <path class="svg-shape" d="M470.58,15.17c-6.03,6.38-21.1,25.09-23.58,59.18h-17.79c2.66-39.31,22.21-59.3,22.21-59.3h-27.55V.22h46.72V15.17Z"/>
                    <path class="svg-shape" d="M495.95,.11l-21.79,.22V74.46h21.79c20.53,0,37.17-16.64,37.17-37.17S516.48,.11,495.95,.11Zm4.41,56.81h-9.28V17.1l9.28-.12c8.74,0,15.83,8.95,15.83,19.98s-7.09,19.97-15.83,19.97Z"/>
                  </g>
                  <g>
                    <path class="cls-1 svg-shape" d="M61.98,0C41.45,0,24.81,16.64,24.81,37.17s16.64,37.17,37.17,37.17,37.17-16.64,37.17-37.17S82.51,0,61.98,0Zm0,55.76c-10.26,0-18.59-8.32-18.59-18.59s8.32-18.59,18.59-18.59,18.59,8.32,18.59,18.59-8.32,18.59-18.59,18.59Z"/>
                    <path class="cls-1 svg-shape" d="M59.72,78.01c-6.25,4.78-14.07,7.61-22.54,7.61C16.64,85.62,0,68.98,0,48.44,0,30.45,12.79,15.44,29.78,12c-5.44,6.95-8.68,15.69-8.68,25.17,0,21.78,17.13,39.65,38.62,40.83Z"/>
                  </g>
                  <g>
                    <path class="svg-shape" d="M610.03,22.98h-6.69c-.27-5.34-2.18-9.41-5.72-12.21-3.55-2.8-8.33-4.21-14.34-4.21-5.67,0-10.1,1.18-13.27,3.55-3.18,2.37-4.76,5.71-4.76,10.03,0,1.55,.19,2.92,.56,4.1,.37,1.18,1.05,2.21,2.03,3.09,.98,.88,1.89,1.61,2.74,2.18,.84,.57,2.21,1.15,4.1,1.72,1.89,.57,3.41,1.01,4.56,1.32,1.15,.3,2.97,.73,5.47,1.27,2.7,.61,4.9,1.11,6.59,1.52,1.69,.41,3.61,.95,5.78,1.62,2.16,.68,3.9,1.35,5.22,2.03,1.32,.68,2.69,1.52,4.1,2.53,1.42,1.01,2.5,2.13,3.24,3.34,.74,1.22,1.37,2.65,1.87,4.31,.51,1.66,.76,3.5,.76,5.52,0,4.93-1.37,9.05-4.1,12.36-2.74,3.31-6.06,5.61-9.98,6.89-3.92,1.28-8.28,1.93-13.07,1.93-8.98,0-16.03-2.19-21.13-6.59-5.1-4.39-7.65-10.44-7.65-18.14v-.61h6.59c0,6.55,2.01,11.48,6.03,14.79,4.02,3.31,9.58,4.97,16.67,4.97,6.21,0,11.11-1.32,14.69-3.95,3.58-2.63,5.37-6.28,5.37-10.94s-1.71-7.75-5.12-9.68c-3.41-1.92-9.85-4-19.3-6.23-3.04-.67-5.29-1.22-6.74-1.62-1.45-.41-3.39-1.11-5.83-2.13-2.43-1.01-4.24-2.11-5.42-3.29-1.18-1.18-2.25-2.79-3.19-4.81-.95-2.03-1.42-4.39-1.42-7.09,0-6.08,2.25-10.89,6.74-14.44,4.49-3.55,10.62-5.32,18.39-5.32s14.08,1.87,18.75,5.62c4.66,3.75,7.16,9.27,7.5,16.57Z"/>
                    <path class="svg-shape" d="M643.06,22.27v5.17h-10.74V60.47c0,1.76,.03,2.99,.1,3.7,.07,.71,.29,1.55,.66,2.53,.37,.98,1.03,1.64,1.98,1.98,.94,.34,2.23,.51,3.85,.51,.95,0,2.33-.1,4.15-.3v5.47c-2.09,.27-3.95,.41-5.57,.41-6.28,0-9.9-1.99-10.84-5.98-.4-1.69-.61-5.5-.61-11.45V27.44h-9.22v-5.17h9.22V6.36h6.28v15.91h10.74Z"/>
                    <path class="svg-shape" d="M694.33,22.27v52.08h-5.88v-9.63c-3.85,7.43-9.97,11.15-18.34,11.15-5.54,0-9.91-1.6-13.12-4.81-3.21-3.21-4.81-7.92-4.81-14.14V22.27h6.38v31.92c0,5.4,1,9.44,2.99,12.11,1.99,2.67,5.39,4,10.18,4,5.07,0,9.05-1.84,11.96-5.52,2.9-3.68,4.36-8.26,4.36-13.73V22.27h6.28Z"/>
                    <path class="svg-shape" d="M752.49,2.2V74.35h-5.78v-10.23c-1.55,3.85-3.97,6.77-7.24,8.76-3.28,1.99-7.11,2.99-11.5,2.99-7.23,0-12.95-2.48-17.17-7.45-4.22-4.97-6.33-11.67-6.33-20.11s2.11-15.06,6.33-20.06c4.22-5,9.88-7.5,16.97-7.5,9.05,0,15.23,3.75,18.54,11.25V2.2h6.18Zm-24.01,23.81c-5.34,0-9.61,2.01-12.82,6.03-3.21,4.02-4.81,9.41-4.81,16.16s1.6,12.36,4.81,16.41c3.21,4.05,7.51,6.08,12.92,6.08s9.91-1.99,13.12-5.98c3.21-3.98,4.81-9.46,4.81-16.41,0-6.21-1.52-11.48-4.56-15.81-3.04-4.32-7.53-6.48-13.48-6.48Z"/>
                    <path class="svg-shape" d="M771.33,1.9V12.34h-6.38V1.9h6.38Zm0,20.37v52.08h-6.38V22.27h6.38Z"/>
                    <path class="svg-shape" d="M805.78,20.75c7.5,0,13.46,2.5,17.88,7.5,4.42,5,6.64,11.75,6.64,20.27s-2.2,15.12-6.59,20.01c-4.39,4.9-10.37,7.35-17.94,7.35s-13.6-2.48-18.09-7.45c-4.49-4.97-6.74-11.67-6.74-20.11s2.25-15.06,6.74-20.06c4.49-5,10.52-7.5,18.09-7.5Zm13.17,11.4c-3.31-4.02-7.74-6.03-13.27-6.03s-9.97,2.01-13.27,6.03c-3.31,4.02-4.96,9.41-4.96,16.16s1.64,12.33,4.91,16.31c3.28,3.99,7.78,5.98,13.53,5.98s9.93-1.99,13.17-5.98c3.24-3.98,4.86-9.39,4.86-16.21s-1.66-12.24-4.97-16.26Z"/>
                    <path class="svg-shape" d="M877.32,37.47h-6.18c-.61-7.56-5.3-11.35-14.08-11.35-3.72,0-6.67,.78-8.87,2.33-2.2,1.55-3.29,3.65-3.29,6.28,0,1.28,.24,2.4,.71,3.34,.47,.95,1.01,1.71,1.62,2.28,.61,.57,1.67,1.13,3.19,1.67,1.52,.54,2.84,.96,3.95,1.27,1.11,.3,2.92,.73,5.42,1.27,2.23,.54,4.02,.98,5.37,1.32,1.35,.34,3.02,.93,5.02,1.77,1.99,.85,3.56,1.76,4.71,2.74,1.15,.98,2.14,2.3,2.99,3.95,.84,1.66,1.27,3.53,1.27,5.62,0,4.8-1.91,8.66-5.72,11.6-3.82,2.94-8.8,4.41-14.95,4.41-6.69,0-11.89-1.62-15.6-4.86-3.72-3.24-5.64-7.84-5.78-13.78h6.18c0,4.32,1.35,7.63,4.05,9.93,2.7,2.3,6.48,3.44,11.35,3.44,4.26,0,7.68-.93,10.28-2.79,2.6-1.86,3.9-4.31,3.9-7.35,0-1.62-.42-3.04-1.27-4.26-.85-1.22-1.98-2.18-3.39-2.89-1.42-.71-2.82-1.28-4.21-1.72-1.39-.44-2.85-.83-4.41-1.17-.47-.07-.81-.13-1.01-.2-.47-.13-1.55-.39-3.24-.76-1.69-.37-2.87-.64-3.55-.81-.68-.17-1.76-.49-3.24-.96-1.49-.47-2.57-.91-3.24-1.32-.68-.41-1.54-.98-2.58-1.72-1.05-.74-1.82-1.54-2.33-2.38-.51-.84-.95-1.84-1.32-2.99-.37-1.15-.56-2.43-.56-3.85,0-4.52,1.71-8.11,5.12-10.74,3.41-2.63,8.09-3.95,14.03-3.95s10.71,1.42,14.29,4.26c3.58,2.84,5.37,6.96,5.37,12.36Z"/>
                  </g>
                </g>
              </g>
            </svg>
        </div>
        
        <!-- Loader de Línea de Progreso -->
        <div class="progress-line-loader-container">
             <span class="progress-line-loader"></span>
        </div>
    
        <!-- Loader de Bolitas -->
        <div class="dots-loader-container">
            <span class="dots-loader"></span> 
        </div>
    
        <p id="loading-message">Cargando aplicación...</p>
    </div>
    <!-- ========= FIN PANTALLA DE CARGA INICIAL ========= -->
    <div class="invoice-generator" style="display: none;">
        <h1>Facturación OSCAR 07D Studios</h1>
        
        <header class="invoice-header">
            <div class="logo-section">
                <h3>Logo y Detalles del Comercio</h3>
                <div class="form-group">
                    <label for="logo-upload">Cargar Logo (SVG, PNG):</label>
                    <div id="logo-upload-wrapper">
                        <input type="file" id="logo-upload" name="logo-upload" accept="image/svg+xml, image/png" aria-labelledby="logo-upload-button-label">
                        <label for="logo-upload" id="logo-upload-button-label" role="button" tabindex="0"></label>
                        <span id="selected-logo-filename">Ningún archivo seleccionado</span>
                    </div>
                </div>
                <div class="logo-preview-container">
                    <img id="logo-preview" src="#" alt="Vista previa Logo">
                </div>
                <div class="form-group" style="margin-top:15px;">
                    <label for="business-details">Detalles del Comercio (NIT, Razón Social, Dirección, etc.):</label>
                    <textarea id="business-details" placeholder="Ej: OSCAR 07D Studios SAS, NIT: 900.123.456-7, Cra 1 # 2-3 Bogotá..."></textarea>
                </div>
            </div>
            <div class="invoice-info">
                <h3>Información de Factura</h3>
                <p>Fecha Factura: <span id="invoice-date-display">--/--/----</span></p>
                <p>Nº Factura: <span id="invoice-number-display">----</span></p>
                <p>Código Único: <span id="invoice-code-display">----</span></p>
            </div>
        </header>

        <section class="invoice-section client-section">
            <h2>Cliente</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="select-client">Cliente Existente:</label>
                    <select id="select-client">
                        <option value="">-- Nuevo Cliente --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Acciones del Cliente Seleccionado:</label>
                    <!-- Contenedor para los botones de acción del cliente -->
                    <div id="client-actions-container" class="action-buttons-group">
                        <button id="delete-client-btn" class="btn btn-danger btn-small hidden">
                            <span class="btn-text">Eliminar</span>
                            <div class="loader"></div>
                        </button>
                        <button id="recover-client-btn" class="btn btn-secondary btn-small hidden">
                            <span class="btn-text">Recuperar</span>
                            <div class="loader"></div>
                        </button>
                    </div>
                </div>
            </div>
            <div id="client-payment-status-area" class="form-group hidden" style="margin-top: 15px;">
                <label>Estado de Pago del Cliente:</label>
                <p id="payment-status-display" style="font-weight: bold;"></p>
            </div>
            <div id="new-client-form-container">
                <h3>Datos del Nuevo Cliente</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="new-client-name">Nombre Completo o Razón Social:</label>
                        <input type="text" id="new-client-name" placeholder="Nombre del cliente">
                    </div>
                    <div class="form-group">
                        <label for="new-client-email">Email:</label>
                        <input type="email" id="new-client-email" placeholder="correo@ejemplo.com">
                    </div>
                    <div class="form-group">
                        <label for="new-client-address">Dirección Fiscal:</label>
                        <input type="text" id="new-client-address" placeholder="Calle/Carrera, Número, Ciudad, Departamento">
                    </div>
                    <div class="form-group">
                        <label for="new-client-phone">Teléfono (Colombia):</label>
                        <input type="tel" id="new-client-phone" placeholder="Ej: 3001234567 o 6011234567" pattern="^(3\d{9}|60\d{8})$" title="Número de 10 dígitos. Móvil (3xx...) o Fijo con indicativo (60x...). Sin +57.">
                    </div>
                    <div class="form-group">
                        <label for="new-client-payment-status">Estado de Pago (General Cliente):</label>
                        <select id="new-client-payment-status">
                            <option value="Pendiente">Pendiente</option>
                            <option value="Pagado">Pagado</option>
                            <option value="Parcialmente Pagado">Parcialmente Pagado</option>
                            <option value="Vencido">Vencido</option>
                        </select>
                    </div>
                </div>
            </div>
            <div id="edit-client-form-container" class="hidden">
                <h3>Editar Cliente: <span id="editing-client-name" style="color:var(--primary-color)"></span></h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="edit-client-name">Nombre:</label>
                        <input type="text" id="edit-client-name">
                    </div>
                    <div class="form-group">
                        <label for="edit-client-email">Email:</label>
                        <input type="email" id="edit-client-email">
                    </div>
                    <div class="form-group">
                        <label for="edit-client-address">Dirección:</label>
                        <input type="text" id="edit-client-address">
                    </div>
                    <div class="form-group">
                        <label for="edit-client-phone">Teléfono (Colombia):</label>
                        <input type="tel" id="edit-client-phone" placeholder="Ej: 3001234567 o 6011234567" pattern="^(3\d{9}|60\d{8})$" title="Número de 10 dígitos. Móvil (3xx...) o Fijo con indicativo (60x...). Sin +57.">
                    </div>
                    <div class="form-group">
                        <label for="edit-client-payment-status">Estado de Pago:</label>
                        <select id="edit-client-payment-status">
                            <option value="Pendiente">Pendiente</option>
                            <option value="Pagado">Pagado</option>
                            <option value="Parcialmente Pagado">Parcialmente Pagado</option>
                            <option value="Vencido">Vencido</option>
                        </select>
                    </div>
                <button id="save-client-changes-btn" class="btn btn-secondary" style="margin-top:15px;">
                    <span class="btn-text">Guardar Cambios del Cliente</span>
                    <div class="loader"></div>
                </button>
        </section>

        <section class="invoice-section items-section">
            <h2>Detalles de la Factura</h2>
            <h3>Añadir Ítem</h3>
            <div class="form-grid" style="align-items: flex-end;">
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label for="item-description">Descripción:</label>
                    <input type="text" id="item-description" list="product-list" placeholder="Producto o servicio">
                    <datalist id="product-list"></datalist>
                </div>
                <div class="form-group">
                    <label for="item-quantity">Cantidad:</label>
                    <input type="number" id="item-quantity" value="1" min="0.01" step="any">
                </div>
                <div class="form-group">
                    <label for="item-price">Precio Unit. (COP $):</label>
                    <input type="number" id="item-price" step="any" min="0" placeholder="Ej: 12000">
                </div>
                <div class="form-group form-group-checkbox" style="align-self: center; padding-top: 15px;">
                    <input type="checkbox" id="apply-item-tax-checkbox" checked>
                    <label for="apply-item-tax-checkbox">Aplicar IVA a este ítem</label>
                </div>
                <button id="add-item-btn" class="btn btn-primary btn-full-width">
                    <span class="btn-text">Agregar Ítem</span>
                    <div class="loader"></div>
                </button>
            </div>

            <h3>Ítems de la Factura</h3>
            <div class="table-responsive-wrapper">
                <table class="item-table">
                    <thead>
                        <tr>
                            <th>Descripción</th>
                            <th class="text-right">Cantidad</th>
                            <th class="text-right">Precio Unit. (COP $)</th>
                            <th class="text-right">Importe (COP $)</th>
                            <th class="text-right">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="invoice-items-tbody"></tbody>
                </table>
            </div>
        </section>

        <section class="invoice-section totals-section">
            <h2>Totales</h2>
            <div class="form-group form-group-checkbox" style="margin-bottom: 20px;">
                <input type="checkbox" id="apply-invoice-tax-checkbox" checked>
                <label for="apply-invoice-tax-checkbox">Aplicar IVA a la Factura</label>
            </div>
            <div class="form-grid">
                <div class="form-group">
                    <label>Subtotal (COP $):</label>
                    <input type="text" id="subtotal-display" readonly value="0">
                </div>
                <div class="form-group" id="tax-percentage-group">
                    <label for="tax-percentage">Impuesto (IVA %):</label>
                    <input type="number" id="tax-percentage" value="19" step="any" min="0" placeholder="Ej: 19">
                </div>
                <div class="form-group" id="tax-amount-group">
                    <label>Total Impuesto (COP $):</label>
                    <input type="text" id="tax-amount-display" readonly value="0">
                </div>
                <div class="form-group">
                    <label style="font-size:1.2rem;">TOTAL FACTURA (COP $):</label>
                    <input type="text" id="total-display" readonly value="0">
                </div>
            </div>
        </section>

        <section class="invoice-section actions-section">
            <h2>Acciones Principales</h2>
            <div class="form-group">
                <button id="generate-invoice-btn" class="btn btn-secondary btn-full-width">
                    <span class="btn-text">Generar y Guardar Factura</span>
                    <div class="loader"></div>
                </button>
            </div>
            <h3 style="margin-top: 30px;">Gestión de Facturas Existentes</h3>
            <div class="form-grid" style="align-items: flex-end;">
                <div class="form-group">
                    <label for="search-invoice-code">Buscar Factura (por Código/Consecutivo):</label>
                    <input type="text" id="search-invoice-code" placeholder="Introduzca código de factura">
                </div>
                <button id="search-invoice-btn" class="btn btn-primary btn-full-width">
                    <span class="btn-text">Buscar Factura</span>
                    <div class="loader"></div>
                </button>
            </div>
            <div id="search-results-div" class="hidden">
                <h4>Resultados de la Búsqueda:</h4>
                <pre id="search-results-content"></pre>
            </div>
            <h3 style="margin-top: 30px;">Opciones Adicionales / Exportar</h3>
            <div class="action-buttons-group" style="margin-top: 15px;">
                <button id="share-whatsapp-btn" class="btn btn-outline">WhatsApp</button>
                <button id="share-email-btn" class="btn btn-outline">Correo</button>
                <button id="export-pdf-btn" class="btn btn-primary">
                    <span class="btn-text">Exportar PDF</span>
                    <div class="loader"></div>
                </button>
                <button id="export-png-btn" class="btn btn-primary">
                    <span class="btn-text">Exportar PNG</span>
                    <div class="loader"></div>
                </button>
            </div>
        </section>

        <div id="status-message-div" class="status-message hidden"></div>
    </div>

    <!-- Plantilla HTML para la factura a exportar (oculta) -->
    <div id="invoice-to-export-wrapper">
        <div id="invoice-to-export">
            <header>
                <div class="header-flex">
                    <div class="export-business-details">
                        <img id="export-logo-img" src="" alt="Logo Comercio" class="export-logo" style="display:none; margin-bottom:15px;" />
                        <p id="export-business-name" style="font-size: 14pt; font-weight:bold; margin-bottom:5px;"></p>
                        <div id="export-business-extra-details" style="white-space: pre-wrap;"></div>
                    </div>
                    <div class="export-invoice-info">
                        <h1 style="font-size: 20pt; margin-bottom:10px;">FACTURA</h1>
                        <p><strong>Nº Factura:</strong> <span id="export-invoice-number"></span></p>
                        <p><strong>Código:</strong> <span id="export-invoice-code"></span></p>
                        <p><strong>Fecha:</strong> <span id="export-invoice-date"></span></p>
                    </div>
                </div>
            </header>
            <hr style="margin: 20px 0;">
            <section class="export-client-info">
                <h3>Cliente:</h3>
                <div id="export-client-details">
                    <p><strong>Nombre:</strong> <span id="export-client-name"></span></p>
                    <p><strong>Email:</strong> <span id="export-client-email"></span></p>
                    <p><strong>Dirección:</strong> <span id="export-client-address"></span></p>
                    <p><strong>Teléfono:</strong> <span id="export-client-phone"></span></p>
                </div>
            </section>
            <hr style="margin: 20px 0;">
            <section class="export-items">
                <h3>Detalle de Ítems:</h3>
                <table class="export-items-table">
                    <thead>
                        <tr>
                            <th>Descripción</th>
                            <th class="number">Cantidad</th>
                            <th class="number">Precio Unit. (COP $)</th>
                            <th class="number">Importe (COP $)</th>
                            <th class="number">IVA Ítem (COP $)</th>
                        </tr>
                    </thead>
                    <tbody id="export-items-tbody">
                    </tbody>
                </table>
            </section>
            <hr style="margin: 20px 0;">
            <section class="export-totals" id="export-totals-section">
                <p><strong>Subtotal:</strong> <span id="export-subtotal"></span> COP $</p>
                <p id="export-tax-line" class="hidden"><strong>Impuesto (<span id="export-tax-percentage"></span>%):</strong> <span id="export-tax-amount"></span> COP $</p>
                <p style="font-size: 12pt; font-weight:bold;"><strong>TOTAL:</strong> <span id="export-total"></span> COP $</p>
            </section>
            <footer>
                <p>Factura generada por Sistema OSCAR 07D Studios</p>
                <p>Gracias por su compra.</p>
            </footer>
        </div>
    </div>
        <!-- ========= BLOQUE DE CONFIGURACIÓN E INICIALIZACIÓN DE FIREBASE (PEGAR AQUÍ) ========= -->
        <script type="module">
          // Import the functions you need from the SDKs you need
          import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.0/firebase-app.js";
          // La siguiente línea de getAnalytics es opcional si solo vas a usar Auth por ahora.
          // Puedes comentarla o quitarla si no la necesitas de inmediato para simplificar.
          // import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.8.0/firebase-analytics.js"; 
          // TODO: Add SDKs for Firebase products that you want to use
          // https://firebase.google.com/docs/web/setup#available-libraries
    
          // Your web app's Firebase configuration
          // For Firebase JS SDK v7.20.0 and later, measurementId is optional
          const firebaseConfig = {
            apiKey: "AIzaSyA3h3uek4kl0Vz0lmLglDb7-xhjrIAMMp4", // Estos son TUS valores
            authDomain: "facturadorweb-29ad0.firebaseapp.com",
            projectId: "facturadorweb-29ad0",
            storageBucket: "facturadorweb-29ad0.firebasestorage.app", // Verifica si es .appspot.com o .firebasestorage.app como te lo dio Firebase
            messagingSenderId: "765670879187",
            appId: "1:765670879187:web:1d7a9082385517fd83c926",
            measurementId: "G-GN1YNRR1S5" // Este es opcional para la Autenticación
          };
    
          // Initialize Firebase
          const app = initializeApp(firebaseConfig);
          // const analytics = getAnalytics(app); // Opcional, puedes comentar esto también
          
          // HACER LA INSTANCIA 'app' ACCESIBLE GLOBALMENTE (PARA SCRIPT.JS NO MODULAR)
          // Solo necesitas esta línea si tu script.js NO es type="module"
          // Si vas a hacer script.js type="module", esta línea no es la forma ideal.
          window.firebaseAppInstance = app; // <--- AÑADE ESTA LÍNEA DENTRO DE ESTE SCRIPT TYPE="MODULE"
                                         // para hacerla accesible a tu script.js actual (si no es un módulo)
    
        </script>
        <!-- =================================================================================== -->
        <!-- El JavaScript se cargará desde script.js -->
        <script src="script.js" defer></script>
</body>
</html>
